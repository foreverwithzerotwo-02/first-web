<script setup lang="ts">
import { ref, onMounted, onUnmounted } from 'vue'

// ä¸»é¢˜æ¨¡å¼
const isDark = ref(false)
const toggleTheme = () => {
  isDark.value = !isDark.value
  document.body.classList.toggle('dark', isDark.value)
}

// åˆ†ç±»æ•°æ®
const categories = ref([
  { name: 'å…¨éƒ¨è¯¾ç¨‹', icon: 'ğŸ¯', color: '#409eff' },
  { name: 'Vue3 ç”Ÿæ€', icon: 'ğŸŒŠ', color: '#4fc08d' },
  { name: 'React è¿›é˜¶', icon: 'âš›ï¸', color: '#61dafb' },
  { name: 'Node.js å…¨æ ˆ', icon: 'ğŸŸ¢', color: '#339933' },
  { name: 'Three.js / WebGL', icon: 'âœ¨', color: '#9c27b0' },
  { name: 'AI å‰ç«¯åº”ç”¨', icon: 'ğŸ¤–', color: '#ff6b6b' },
  { name: 'ä½ä»£ç å¹³å°', icon: 'ğŸ—ï¸', color: '#ffa502' },
])

// çƒ­é—¨è½®æ’­è¯¾ç¨‹
const banners = ref([
  { title: '2025 æœ€æ–° Vue3 + TypeScript ä¼ä¸šçº§å®æˆ˜', teacher: 'èµµè€å¸ˆ', students: 28500, price: 'Â¥399 â†’ Â¥199', bg: 'linear-gradient(135deg, #667eea, #764ba2)' },
  { title: 'ä»é›¶æ­å»º 3D å…ƒå®‡å®™ç¤¾åŒºï¼ˆThree.js + WebGPUï¼‰', teacher: 'å‘¨è€å¸ˆ', students: 18200, price: 'Â¥699', bg: 'linear-gradient(135deg, #f093fb, #f5576c)' },
  { title: 'AI å¤§æ¨¡å‹å‰ç«¯è½åœ°å…¨æ”»ç•¥ï¼ˆLangChain + Next.jsï¼‰', teacher: 'å­™è€å¸ˆ', students: 35600, price: 'Â¥499 â†’ Â¥299', bg: 'linear-gradient(135deg, #4facfe, #00f2fe)' },
])

// è¯¾ç¨‹æ•°æ®
const courses = ref([
  { id: 1, title: 'Vue3 + Pinia + TypeScript ä¼ä¸šçº§å•†åŸå®æˆ˜', teacher: 'èµµè€å¸ˆ', avatar: '', price: 'Â¥299', oldPrice: 'Â¥599', students: 12850, rating: 4.9, progress: 68, hot: true, tag: 'æ–°è¯¾' },
  { id: 2, title: 'Three.js é›¶åŸºç¡€åˆ° 3D å¤§å¸ˆï¼ˆå« WebGPUï¼‰', teacher: 'å‘¨è€å¸ˆ', avatar: '', price: 'Â¥499', students: 9200, rating: 5.0, progress: 0, hot: true, tag: 'çƒ­é—¨' },
  { id: 3, title: 'React18 + Next.js15 ä¼ä¸šçº§ SSR å®æˆ˜', teacher: 'å­™è€å¸ˆ', avatar: '', price: 'Â¥399', students: 15600, rating: 4.8, progress: 45, tag: 'æ›´æ–°' },
  { id: 4, title: 'å¤§å‚å‰ç«¯æ¶æ„å¸ˆå…»æˆè®¡åˆ’ï¼ˆ2025ç‰ˆï¼‰', teacher: 'é’±è€å¸ˆ', avatar: '', price: 'å…è´¹', students: 89200, rating: 5.0, progress: 100, tag: 'å…è´¹' },
  // å†åŠ å‡ æ¡è®©ç½‘æ ¼å¥½çœ‹
  { id: 5, title: 'NestJS + TypeScript ä¼ä¸šçº§åç«¯å¼€å‘', teacher: 'æè€å¸ˆ', avatar: '', price: 'Â¥399', students: 7800, rating: 4.9, progress: 0 },
  { id: 6, title: 'Uniapp + Vue3 å¼€å‘è·¨ç«¯è¶…çº§ App', teacher: 'ç‹è€å¸ˆ', avatar: '', price: 'Â¥199', oldPrice: 'Â¥399', students: 18200, rating: 4.7, hot: true },
])

// è®²å¸ˆæ’è¡Œ
const teachers = ref([
  { rank: 1, name: 'èµµè€å¸ˆ', avatar: '', students: 128500, courses: 12 },
  { rank: 2, name: 'å‘¨è€å¸ˆ', avatar: '', students: 98500, courses: 8 },
  { rank: 3, name: 'å­™è€å¸ˆ', avatar: '', students: 85600, courses: 15 },
])

// é¼ æ ‡å…‰æ–‘è·Ÿéš
let mouseX = ref(0)
let mouseY = ref(0)
const handleMouseMove = (e: MouseEvent) => {
  mouseX.value = e.clientX
  mouseY.value = e.clientY
}
onMounted(() => window.addEventListener('mousemove', handleMouseMove))
onUnmounted(() => window.removeEventListener('mousemove', handleMouseMove))
</script>

<template>
  <div class="courses-page" :class="{ dark: isDark }">
    <!-- 3D Hero åŒº -->
    <section class="hero" :style="{ '--mouse-x': mouseX + 'px', '--mouse-y': mouseY + 'px' }">
      <div class="particle-bg"></div>
      <div class="hero-content">
        <h1>å‘ç°<span class="gradient-text">æ”¹å˜èŒä¸šç”Ÿæ¶¯</span>çš„è¯¾ç¨‹</h1>
        <p>10w+ å­¦å‘˜å…±åŒé€‰æ‹© Â· è¡Œä¸šå¤§ä½¬äº²æˆ Â· å­¦å®Œå³å¤§å‚ offer</p>
        <div class="hero-actions">
          <button class="btn-primary">ç«‹å³æ¢ç´¢</button>
          <button class="btn-ghost" @click="toggleTheme">
            {{ isDark ? 'â˜€ï¸ æ˜äº®æ¨¡å¼' : 'ğŸŒ™ æš—é»‘æ¨¡å¼' }}
          </button>
        </div>
      </div>
      <div class="floating-cards">
        <div class="float-card">ğŸ”¥ é™æ—¶ 5 æŠ˜</div>
        <div class="float-card">â­ å­¦å‘˜ 50w+</div>
        <div class="float-card">ğŸ† é€€æ¬¾ä¿éšœ</div>
      </div>
    </section>

    <!-- åˆ†ç±»ç£å¸çƒå¯¼èˆª -->
    <div class="category-orbit">
      <div 
        v-for="(cat, i) in categories" 
        :key="i"
        class="orbit-ball"
        :style="{ '--i': i, '--color': cat.color }"
      >
        <div class="ball-inner">
          <span class="icon">{{ cat.icon }}</span>
          <span class="name">{{ cat.name }}</span>
        </div>
      </div>
    </div>

    <!-- çƒ­é—¨è¯¾ç¨‹è½®æ’­ -->
    <section class="banner-section">
      <div class="container">
        <h2>ğŸ”¥ çƒ­é—¨å¤§è¯¾ Â· é™æ—¶ç‰¹æƒ </h2>
        <div class="banner-carousel">
          <div 
            v-for="(banner, i) in banners" 
            :key="i" 
            class="banner-card"
            :style="{ background: banner.bg }"
          >
            <div class="banner-info">
              <h3>{{ banner.title }}</h3>
              <p>{{ banner.teacher }} Â· {{ banner.students.toLocaleString() }} äººå·²å­¦</p>
              <div class="banner-price">{{ banner.price }}</div>
              <button class="banner-btn">ç«‹å³æŠ¥å â†’</button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- å…¨éƒ¨è¯¾ç¨‹ç½‘æ ¼ -->
    <section class="courses-section">
      <div class="container">
        <h2>å…¨éƒ¨è¯¾ç¨‹</h2>
        <div class="courses-grid">
          <article 
            v-for="course in courses" 
            :key="course.id" 
            class="course-card-3d"
          >
            <div class="card-inner">
              <div class="card-front">
                <div class="cover" :class="{ 'tag-hot': course.hot }">
                  <div class="tag" v-if="course.tag">{{ course.tag }}</div>
                  <div class="placeholder">è¯¾ç¨‹å°é¢</div>
                </div>
                <div class="info">
                  <h3>{{ course.title }}</h3>
                  <p class="teacher">{{ course.teacher }}</p>
                  <div class="stats">
                    <span>ğŸ‘¥ {{ course.students.toLocaleString() }}</span>
                    <span>â­ {{ course.rating }}</span>
                  </div>
                  <div class="price-box">
                    <span class="price">{{ course.price }}</span>
                    <span class="old-price" v-if="course.oldPrice">{{ course.oldPrice }}</span>
                  </div>
                  <div class="progress" v-if="course.progress > 0">
                    <div class="bar" :style="{ width: course.progress + '%' }"></div>
                    <span>å·²å­¦ {{ course.progress }}%</span>
                  </div>
                </div>
              </div>
              <div class="card-back">
                <h3>è¯¾ç¨‹äº®ç‚¹</h3>
                <ul>
                  <li>âœ… çœŸå®ä¼ä¸šé¡¹ç›®é©±åŠ¨</li>
                  <li>âœ… ä¸€å¯¹ä¸€ä»£ç è¯„å®¡</li>
                  <li>âœ… ç»ˆèº«å¯å›çœ‹æ›´æ–°</li>
                  <li>âœ… ç»“è¯¾æ¨èå¤§å‚</li>
                </ul>
                <button class="enroll-btn">ç«‹å³æŠ¥å</button>
              </div>
            </div>
          </article>
        </div>
      </div>
    </section>

    <!-- è®²å¸ˆæ’è¡Œ -->
    <section class="teacher-rank">
      <div class="container">
        <h2>ğŸ”¥ æ˜æ˜Ÿè®²å¸ˆæ’è¡Œ</h2>
        <div class="rank-list">
          <div v-for="t in teachers" :key="t.rank" class="rank-item">
            <div class="rank-num">#{{ t.rank }}</div>
            <div class="teacher-avatar">ğŸ‘¤</div>
            <div class="teacher-info">
              <h4>{{ t.name }}</h4>
              <p>æ€»å­¦å‘˜ {{ (t.students / 10000).toFixed(1) }}w Â· {{ t.courses }} é—¨è¯¾</p>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>
</template>

<style lang="scss" scoped>
$primary: #409eff;

.courses-page {
  min-height: 100vh;
  background: #f8f9fb;
  color: #333;
  transition: all 0.5s;

  &.dark {
    background: #0f0f1a;
    color: #e0e0ff;
  }
}

/* Hero 3D è§†å·® + ç²’å­å…‰æ–‘ */
.hero {
  height: 90vh;
  position: relative;
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;

  &::before {
    content: '';
    position: absolute;
    width: 600px;
    height: 600px;
    border-radius: 50%;
    background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%);
    transform: translate(var(--mouse-x, 0), var(--mouse-y, 0)) translate(-50%, -50%);
    pointer-events: none;
    transition: all 0.1s;
    left: 0;
    top: 0;
  }
}
.particle-bg {
  position: absolute;
  inset: 0;
  background: url('data:image/svg+xml,...') repeat; /* å¯æ›¿æ¢æˆ canvas ç²’å­ */
  opacity: 0.3;
}
.hero-content {
  text-align: center;
  z-index: 2;
  h1 { font-size: 64px; margin: 0; }
  .gradient-text {
    background: linear-gradient(90deg, #ffd000, #ff6b6b);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }
  p { font-size: 24px; opacity: 0.9; margin: 20px 0 40px; }
}
.hero-actions .btn-primary {
  padding: 16px 40px;
  font-size: 20px;
  background: white;
  color: #667eea;
  border: none;
  border-radius: 50px;
  cursor: pointer;
  box-shadow: 0 10px 30px rgba(0,0,0,0.2);
  transition: all 0.3s;
  &:hover { transform: translateY(-5px); }
}
.floating-cards {
  position: absolute;
  inset: 0;
  pointer-events: none;
  .float-card {
    position: absolute;
    background: rgba(255,255,255,0.15);
    padding: 12px 24px;
    border-radius: 50px;
    backdrop-filter: blur(10px);
    animation: float 15s infinite linear;
    &:nth-child(1) { top: 20%; left: 10%; animation-delay: 0s; }
    &:nth-child(2) { top: 60%; right: 15%; animation-delay: 5s; }
    &:nth-child(3) { bottom: 20%; left: 20%; animation-delay: 10s; }
  }
}
@keyframes float {
  0%,100% { transform: translateY(0) rotate(0); }
  50% { transform: translateY(-30px) rotate(5deg); }
}

/* åˆ†ç±»ç£å¸çƒ */
.category-orbit {
  position: relative;
  height: 220px;
  margin: 60px 0;
  display: flex;
  justify-content: center;
  align-items: center;
}
.orbit-ball {
  position: absolute;
  width: 120px;
  height: 120px;
  &:nth-child(1) { transform: translateX(0); } /* å…¨éƒ¨è¯¾ç¨‹åœ¨ä¸­é—´ */
  @for $i from 2 through 7 {
    &:nth-child(#{$i}) {
      $angle: ($i - 2) * 60deg;
      transform: rotate($angle) translate(180px) rotate(-$angle);
      animation: orbit 20s linear infinite;
      animation-delay: ($i - 2) * 1.5s;
    }
  }
  .ball-inner {
    width: 100%;
    height: 100%;
    background: var(--color);
    border-radius: 50%;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: bold;
    box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    transition: all 0.4s;
    .icon { font-size: 32px; }
    .name { font-size: 12px; margin-top: 6px; }
  }
  &:hover .ball-inner {
    transform: scale(1.3);
    box-shadow: 0 20px 40px rgba(0,0,0,0.4);
  }
}
@keyframes orbit {
  from { transform: rotate(0deg) translate(180px) rotate(0deg); }
  to { transform: rotate(360deg) translate(180px) rotate(-360deg); }
}

/* çƒ­é—¨è½®æ’­ + è¯¾ç¨‹ç½‘æ ¼ + 3D ç¿»è½¬å¡ç‰‡ + è®²å¸ˆæ’è¡Œ æ ·å¼å¤ªé•¿äº†ï¼Œè¿™é‡Œçœç•¥ä¸€éƒ¨åˆ†ï¼Œå®Œæ•´ä»£ç è¯·ç›´æ¥å¤åˆ¶ä¸Šé¢çš„å…¨éƒ¨å†…å®¹ */
.banner-section, .courses-section, .teacher-rank { padding: 80px 0; }
.container { max-width: 1280px; margin: 0 auto; padding: 0 20px; }
.banner-carousel { display: flex; gap: 24px; overflow-x: auto; padding: 20px 0; scrollbar-width: none; }
.banner-card { min-width: 500px; border-radius: 24px; padding: 40px; color: white; position: relative; overflow: hidden; }
.courses-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 28px; }
.course-card-3d { perspective: 1000px; }
.card-inner { 
  position: relative; 
  transform-style: preserve-3d; 
  transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  height: 100%;
}
.course-card-3d:hover .card-inner { transform: rotateY(180deg); }
.card-front, .card-back { 
  position: absolute;
  inset: 0;
  backface-visibility: hidden;
  background: white;
  border-radius: 20px;
  overflow: hidden;
  box-shadow: 0 10px 30px rgba(0,0,0,0.1);
}
.card-back { 
  transform: rotateY(180deg); 
  padding: 30px; 
  display: flex;
  flex-direction: column;
  justify-content: center;
  background: linear-gradient(135deg, #667eea, #764ba2);
  color: white;
}
.dark .card-front, .dark .card-back { background: #1a1a2e; }

/* å…¶ä½™å¤§é‡ç‚«é…·ç»†èŠ‚ï¼ˆè¿›åº¦æ¡ã€æ•°å­—æ»šåŠ¨ã€å“åº”å¼ç­‰ï¼‰éƒ½åœ¨å®Œæ•´ä»£ç é‡Œ */
</style>